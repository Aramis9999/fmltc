<!DOCTYPE html>
<!--
Copyright 2020 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html>
<head>
  <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">
  <link rel="stylesheet" type="text/css"
      href="https://storage.googleapis.com/{{project_id}}/static/css/styles.css?ignoreCache={{time_time}}">
  <script type="text/javascript"
      src="https://storage.googleapis.com/{{project_id}}/compiled/js/fmltc.js?ignoreCache={{time_time}}">
  </script>
</head>
<body>

<canvas id="bboxCanvas" style="position: absolute;"></canvas>

<table>
  <tr>
    <td valign="top">
      <table style="width: 100%"><tr>
        <td><button id="dismissButton">&#x274C;</button></td>
        <td style="width: 100%"><span id="videoFilenameSpan" class="bigText"></span></td>
        <td><button id="smallerImageButton" title="Smaller" disabled="true">&#45;</button></td>
        <td><button id="largerImageButton" title="Larger" disabled="true">&#43;</button></td>
      </tr></table>
    </td>
    <td valign="top">
      <span id="videoFrameCountSpan" class="bigText"></span><span class="bigText">&nbsp;Frames&nbsp;</span>
      <progress id="loadingProgress" value="0" max="100"></progress>
      <span id="loadingFailedSpan" style="display: none">Loading Failed!</span>
    </td>
  </tr>
  <tr>
    <td valign="top">
      <div><img id="videoFrameImg"></img></div>
    </td>
    <td valign="top">
      <div id="includedFrameCountDiv" style="visibility: hidden">Included frames: <span id="includedFrameCountSpan"></span></div>
      <div id="negativeFrameCountDiv" style="visibility: hidden">Negative frames: <span id="negativeFrameCountSpan"></span></div>
      <hr>
      <div>Frame <span id="currentFrameSpan"></span></div>
      <div><input type="checkbox" id="includeFrameInDatasetCheckbox">
        <label for="includeFrameInDatasetCheckbox">Include this frame in the data set</label>
      </div>
      <table id="labelingAreaTable" border="1">
        <tr><th width="50">X1</th><th width="50">Y1</th><th width="50">X2</th><th width="50">Y2</th><th width="50">Label</th></tr>
      </table>
      <div id="labelHintDiv" class="hidden">To continue, each bounding box must have a label.</div>
    </td>
  </tr>
</table>

<table>
  <tr>
    <td valign="top">
      <div>
        <button class="bigText" id="firstFrameButton" title="Go to the First Frame" disabled="true">&#x23EE;</button>
        <button class="bigText" id="previousTenFrameButton" title="Go Back Ten Frames" disabled="true">&#x2B05;</button>
        <button class="bigText" id="previousFrameButton" title="Go Back One Frame" disabled="true">&#x25C0;</button>
        <button class="bigText" id="nextFrameButton" title="Go Forward One Frame" disabled="true">&#x25B6;</button>
        <button class="bigText reverseDisplay" id="nextTenFrameButton" title="Go Forward Ten Frames"" disabled="true">&#x2B05;</button>
        <button class="bigText" id="lastFrameButton" title="Go to the Last Frame" disabled="true">&#x23ED;</button>
      </div>
      <hr>
      <div>Negative Frames</div>
      <div>
        <button class="bigText reverseDisplay" id="previousNegativeFrameButton" title="Go Back to the Previous Negative Frame" disabled="true">&#x2935;</button>
        <button class="bigText" id="nextNegativeFrameButton" title="Go Forward to the Next Negative Frame" disabled="true">&#x2935;</button>
      </div>
      <hr>
      <div><label for="playbackSpeedInput">Playback Speed:</label>
        <input type="range" id="playbackSpeedInput" name="playbackSpeedInput" min="1" value="4" max="24"></div>
      <div>
        <button class="bigText reverseDisplay" id="reversePlayPauseButton" title="Play/Pause Reverse" class="reverseDisplay" disabled="true">&#x23EF;</button>
        <button class="bigText" id="forwardPlayPauseButton" title="Play/Pause Forward" disabled="true">&#x23EF;</button>
      </div>
    </td>
    <td valign="top" style="padding-left: 20px;">
      <div class="bigText">Tracking</div>
      <div>
        <label for="trackerSelect">Algorithm:</label>&nbsp;<select id="trackerSelect">
          <option value="CSRT">CSRT</option>
          <option value="MedianFlow">MedianFlow</option>
          <option value="MIL">MIL</option>
          <option value="MOSSE">MOSSE</option>
          <option value="TLD">TLD</option>
          <option value="KCF">KCF</option>
          <option value="Boosting">Boosting</option>
        </select>
      </div>
      <div><label for="trackingScaleInput">Scale:</label>&nbsp;
        <input id="trackingScaleInput" type="number" class="rightText" value="1.3" min="1" max="3" style="width: 5ch"></div>
      <div>
        <button id="trackingStartButton" title="Start Tracking" class="biggerText" disabled="true">&#x1F6E4;</button>
        <button id="trackingPauseButton" title="Pause Tracking" class="biggerText" disabled="true">&#x23F8;</button>
        <button id="trackingContinueButton" title="Approve These Boxes and Continue Tracking" class="biggerText" disabled="true">&#x2705;&#x25B6;</button>
        <button id="trackingStopButton" title="Stop Tracking" class="biggerText" disabled="true">&#x23F9;</button>
      </div>
      <span id="drawHintDiv" class="hidden">To enable tracking, draw bounding boxes on this xframe.</span>
      <div id="trackingStoppedDiv" style="visibility: hidden">Stopped!</div>
      <div id="trackingFinishedDiv" style="visibility: hidden">Finished!</div>
      <div id="trackingFailedDiv" style="visibility: hidden">Stopped unexpectedly</div>
    </td>
    <td valign="top" style="padding-left: 20px;">
      <button class="bigText" id="button1" title="Button 1" style="display: none"></button><br>
      <button class="bigText" id="button2" title="Button 2" style="display: none"></button><br>
    </td>
    <td valign="top" style="padding-left: 20px;">
      <button class="bigText" id="button3" title="Button 3" style="display: none"></button><br>
      <button class="bigText" id="button4" title="Button 4" style="display: none"></button><br>
    </td>
    <td valign="top" style="padding-left: 20px;">
      <button class="bigText" id="button5" title="Button 5" style="display: none"></button><br>
      <button class="bigText" id="button6" title="Button 6" style="display: none"></button><br>
    </td>
  </tr>
</table>

<script type="text/javascript">
  window.addEventListener('load', function() {
    const util = new fmltc.Util({{ http_perform_action_url|tojson }}, {{ team_preferences|tojson }});
    new fmltc.LabelVideo(util, {{ video_entity|tojson }});
  });
</script>
</body>
</html>
