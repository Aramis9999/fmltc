<!DOCTYPE html>
<!--
Copyright 2020 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html>
<head>
  <link rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">
  <link rel="stylesheet" type="text/css"
      href="https://storage.googleapis.com/{{project_id}}/static/css/styles.css?ignoreCache={{time_time}}">
  <script type="text/javascript"
      src="https://storage.googleapis.com/{{project_id}}/compiled/js/fmltc.js?ignoreCache={{time_time}}">
  </script>
</head>
<body>

<div class="tabButtonsDiv">
  <button id='videosTabButton' class="tabButton">Videos</button>
  <button id='datasetsTabButton' class="tabButton">Datasets</button>
  <button id='modelsTabButton' class="tabButton">Models</button>
</div>

<div id="videosTabDiv" class="tabDiv">
  <table class="collapsedBorder">
    <tr>
      <td align="center" valign="top">
        <button id="uploadVideoFileButton" class="text-24">
          <span class="material-icons iconVerticalAlign">cloud_upload</span><span class="iconVerticalAlign">Upload Video</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="produceDatasetButton" class="text-24">
          <span class="material-icons iconVerticalAlign">construction</span><span class="iconVerticalAlign">Produce Dataset</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="deleteVideosButton" class="text-24">
          <span class="material-icons iconVerticalAlign">delete</span><span class="iconVerticalAlign">Delete Video</span>
        </button>
      </td>
      <td width="10px"></td>
    </tr>
  </table>
  <br>
  <div id="videosListDiv" style="display: none;">
    <table id="videosTable" class="collapsedBorder">
      <tr>
        <th rowspan="2" class="cellWithBorder"><input type="checkbox" id="videoCheckboxAll"></th>
        <th rowspan="2" class="cellWithBorder">Video Filename</th>
        <th rowspan="2" class="cellWithBorder">Date Uploaded</th>
        <th rowspan="2" class="cellWithBorder">File Size</th>
        <th rowspan="2" class="cellWithBorder">Dimensions</th>
        <th rowspan="2" class="cellWithBorder">Duration</th>
        <th rowspan="2" class="cellWithBorder">Frames<br>per<br>Second</th>
        <th colspan="3" class="cellWithBorder">Number of Frames</th>
      </tr>
      <tr>
        <th class="cellWithBorder">In Video</th>
        <th class="cellWithBorder">Extracted</th>
        <th class="cellWithBorder">Excluded</th>
      </tr>
    </table>
  </div>
</div>

<div id="uploadVideoFileDialog" class="modal_dialog"><div class="modal_dialog_container">
  <div class="modal_dialog_content">
    <table>
      <tr>
        <td valign="top">
          <button id="uvfDismissButton" class="material-icons iconVerticalAlign text-24">close</button>
        </td>
        <td valign="top"><span class="modal_dialog_title">Upload Video File</span></td>
      </tr>
    </table>
    <input type="file" id="uvfVideoFileInput" accept="video/*" class="text-18" style="width: 100%">
    <br><br>
    <button id="uvfUploadButton" class="text-18">Upload</button>
    <h3 id="uvfUploadingH3" style="visibility: hidden;">Uploading Progress</h3>
    <div><progress id="uvfUploadingProgress" style="visibility: hidden;"></progress></div>
    <div id="uvfUploadingFinishedDiv" class="text-24" style="display: none;">
      Uploading has finished.
    </div>
    <div id="uvfUploadingFailedDiv" class="text-24" style="display: none;">
      Uploading has failed!
    </div>
  </div>
</div></div>

<div id="produceDatasetDialog" class="modal_dialog"><div class="modal_dialog_container">
  <div class="modal_dialog_content">
    <table>
      <tr>
        <td valign="top">
          <button id="pdDismissButton" class="material-icons iconVerticalAlign text-18">close</button>
        </td>
        <td valign="top"><span class="modal_dialog_title">Produce Dataset</span></td>
      </tr>
    </table>
    <table class="text-18">
      <tr>
        <td><label for="pdTrainPercentInput">Percentage of Frames for Training:</label></td>
        <td><input id="pdTrainPercentInput" type="number" class="rightText text-18"
        value="80" min="10" max="100" style="width: 5ch">&percnt;</td>
      </tr>
      <tr>
        <td><label for="pdEvalPercentInput">Percentage of Frames for Evaluation:</label></td>
        <td><input id="pdEvalPercentInput" type="number" class="rightText text-18"
        value="20" min="0" max="90" style="width: 5ch">&percnt;</td>
      </tr>
    </table>
    <br><br>
    <button id="pdStartButton" class="text-24">Produce Dataset</button>
    <br>
    <div id="pdInProgressDiv" style="display: none;">In Progress...</div>
    <div id="pdFinishedDiv" style="display: none;">Finished.</div>
    <div id="pdFailedDiv" style="display: none;">Failed!</div>
  </div>
</div></div>

<div id="deleteConfirmationDialog" class="modal_dialog"><div class="modal_dialog_container">
  <div class="modal_dialog_content"><center>
    <div id="dcTitle" class="modal_dialog_title"></div>
    <br>
    <div id="dcMessage"></div>
    <br>
    <table width="100%">
      <tr>
        <td align="center"><button id="dcNoButton">No</button></td>
        <td align="center"><button id="dcYesButton">Yes</button></td>
      </tr>
    </table>
  </center></div>
</div></div>

<div id="datasetsTabDiv" class="tabDiv">
  <table class="collapsedBorder">
    <tr>
      <td align="center" valign="top">
        <button id="downloadDatasetButton" class="text-24">
          <span class="material-icons iconVerticalAlign">cloud_download</span><span class="iconVerticalAlign">Download Dataset</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="startTrainingButton" class="text-24">
          <span class="material-icons iconVerticalAlign">model_training</span><span class="iconVerticalAlign">Produce Model</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="deleteDatasetsButton" class="text-24">
          <span class="material-icons iconVerticalAlign">delete</span><span class="iconVerticalAlign">Delete Dataset</span>
        </button>
      </td>
      <td width="10px"></td>
    </tr>
  </table>
  <br>
  <div id="datasetsListDiv">
    <table id="datasetsTable" class="collapsedBorder">
      <tr>
        <th rowspan="3" class="cellWithBorder"><input type="checkbox" id="datasetCheckboxAll"></th>
        <th rowspan="3" class="cellWithBorder">Video Filenames</th>
        <th rowspan="3" class="cellWithBorder">Date Produced</th>
        <th colspan="4" class="cellWithBorder">Number of Frames</th>
        <th rowspan="3" class="cellWithBorder">Labels</th>
      </tr>
      <tr>
        <th colspan="2" class="cellWithBorder">Training</th>
        <th colspan="2" class="cellWithBorder">Evaluation</th>
      </tr>
      <tr>
        <th class="cellWithBorder">Total</th>
        <th class="cellWithBorder">Negative</th>
        <th class="cellWithBorder">Total</th>
        <th class="cellWithBorder">Negative</th>
      </tr>
    </table>
  </div>
</div>

<div id="startTrainingDialog" class="modal_dialog"><div class="modal_dialog_container">
  <div class="modal_dialog_content">
    <table>
      <tr>
        <td valign="top">
          <button id="stDismissButton" class="material-icons iconVerticalAlign text-18">close</button>
        </td>
        <td valign="top"><span class="modal_dialog_title">Start Training a Model</span></td>
      </tr>
    </table>
    <table class="text-18">
      <tr>
        <td colspan="2">
          Each team is allowed <span id="stTotalTrainingMinutesSpan"></span> minutes of training
          time.<br>Your team has <span id="stRemainingTrainingMinutesSpan"></span> minutes of training
          time remaining.
        </td>
      </tr>
      <tr>
        <td><label for="stMaxRunningMinutesInput">Maximum Training Time:</label></td>
        <td><input id="stMaxRunningMinutesInput" type="number" class="rightText text-18"
        style="width: 5ch">Minutes</td>
      </tr>
      <tr>
        <td><label for="stNumTrainingStepsInput">Number of Training Steps:</label></td>
        <td><input id="stNumTrainingStepsInput" type="number" class="rightText text-18"
        style="width: 8ch"></td>
      </tr>
    </table>
    <br><br>
    <button id="stStartButton" class="text-24">Start Training</button>
    <br>
    <div id="stInProgressDiv" style="display: none;">Submitting job request...</div>
    <div id="stSuccessDiv" style="display: none;">Training job is queued.</div>
    <div id="stFailedDiv" style="display: none;">Failed!</div>
  </div>
</div></div>

<div id="modelsTabDiv" class="tabDiv">
  <table class="collapsedBorder">
    <tr>
      <td align="center" valign="top">
        <button id="downloadTFLiteButton" class="text-24">
          <span class="material-icons iconVerticalAlign">cloud_download</span><span class="iconVerticalAlign">Download Model</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="cancelTrainingButton" class="text-24">
          <span class="material-icons iconVerticalAlign">cancel</span><span class="iconVerticalAlign">Cancel Training</span>
        </button>
      </td>
      <td width="10px"></td>
      <td align="center" valign="top">
        <button id="deleteModelsButton" class="text-24">
          <span class="material-icons iconVerticalAlign">delete</span><span class="iconVerticalAlign">Delete Model</span>
        </button>
      </td>
      <td width="10px"></td>
    </tr>
  </table>
  <div id="modelsListDiv">
    <table id="modelsTable" class="collapsedBorder">
      <tr>
        <th rowspan="2" class="cellWithBorder"><input type="checkbox" id="modelCheckboxAll"></th>
        <th rowspan="2" class="cellWithBorder">Video Filenames</th>
        <th rowspan="2" class="cellWithBorder">Date Created</th>
        <th colspan="2" class="cellWithBorder">State</th>
        <th rowspan="2" class="cellWithBorder">Training Time</th>
      </tr>
      <tr>
        <th class="cellWithBorder">Training</th>
        <th class="cellWithBorder">Evaluation</th>
      </tr>
    </table>
  </div>
</div>

<script type="text/javascript">
  window.addEventListener('load', function() {
    const util = new fmltc.Util('root', {{ http_perform_action_url|tojson }}, {{ team_preferences|tojson }});
    const listModels = new fmltc.ListModels(util);
    const listDatasets = new fmltc.ListDatasets(util, listModels);
    new fmltc.ListVideos(util, listDatasets);
  });
</script>
</body>
</html>
